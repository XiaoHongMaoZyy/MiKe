using System;
using System . Collections . Generic;
using System . Linq;
using System . Text;
using System . Threading . Tasks;
using StudentMgr;
using System . Data;

namespace LineProductMesBll . Dao
{
    public class SalaryByEveryOneDao
    {
        /// <summary>
        /// 获取数据列表
        /// </summary>
        /// <param name="dt"></param>
        /// <returns></returns>
        public DataTable getTableView ( string dt )
        {
            StringBuilder strSql = new StringBuilder ( );
            strSql . AppendFormat ( "SELECT ANX001,ANX011,ANX002,ANX003,ANX004,ANX005,ANX006,ANX007,ANX008,ANX017,ANW011,ANW013,ANX015,ANX016,ISNULL(ANX015,0)+ISNULL(ANX016,0) ANX,ANW020 FROM MIKANX A INNER JOIN MIKANW B ON A.ANX001=B.ANW001 WHERE CONVERT(NVARCHAR,ANW015,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT ANV001,ANV007,ANV002,ANV003,ANV004,ANV013,ANV014,ANV005,ANV006,ANV010,ANT003,ANT005,ANV015,ANV009,ISNULL(ANV015,0)+ISNULL(ANV009,0) ANV,ANT006 FROM MIKANV A INNER JOIN MIKANT B ON A.ANV001=B.ANT001 WHERE CONVERT(NVARCHAR,ANT014,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT HAX001,HAX015,HAX002,HAX003,HAX004,HAX009,HAX010,HAX011,HAX012,HAX020,HAW013,HAW015,HAX018,HAX019,ISNULL(HAX018,0)+ISNULL(HAX019,0) HAX,HAW018 FROM MIKHAX A INNER JOIN MIKHAW B ON A.HAX001=B.HAW001 WHERE CONVERT(NVARCHAR,HAW024,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT IJB001,IJB003,IJB002,IJB012,IJB013,IJB016,IJB017,IJB018,IJB019,IJB025,IJA004,IJA006,IJB024,IJB023,ISNULL(IJB024,0)+ISNULL(IJB023,0) IJB,IJA010 FROM MIKIJB A INNER JOIN MIKIJA B ON A.IJB001=B.IJA001 WHERE CONVERT(NVARCHAR,IJA015,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT IJD001,IJD010,IJD002,IJD003,IJD004,NULL,NULL,IJD006,IJD007,IJD013,IJA004,IJA006,NULL,IJD012,IJD012 IJD,IJA010 FROM MIKIJD A INNER JOIN MIKIJA B ON A.IJD001=B.IJA001 WHERE CONVERT(NVARCHAR,IJA015,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT LEG001,LEG012,LEG002,LEG003,LEG004,LEG005,LEG006,LEG008,LEG009,LEG016,LEF010,LEF012,LEG014,LEG015,ISNULL(LEG014,0)+ISNULL(LEG015,0) LEG,LEF017 FROM MIKLEG A INNER JOIN MIKLEF B ON A.LEG001=B.LEF001 WHERE CONVERT(NVARCHAR,LEF023,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT LEC001,LED012,LED002,LED003,LED004,LED005,LED006,LED008,LED009,LED016,LEC010,LEC012,LED014,LED015,ISNULL(LED014,0)+ISNULL(LED015,0) LED,LEC017 FROM MIKLED A INNER JOIN MIKLEC B ON A.LED001=B.LEC001 WHERE CONVERT(NVARCHAR,LEC023,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT LGP001,LGP005,LGP002,LGP003,LGP004,LGP009,LGP010,LGP007,LGP008,LGP013,'',LGP006,LGP011,LGP012,ISNULL(LGP011,0)+ISNULL(LGP012,0) LGP,LGN003 FROM MIKLGP A INNER JOIN MIKLGN B ON A.LGP001=B.LGN001 WHERE CONVERT(NVARCHAR,LGN009,112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            strSql . AppendFormat ( "SELECT PAP001,PPA010,PPA002,PPA003,PPA004,PPA005,PPA006,PPA007,PPA008,PPA014,PAN003,PAN005,PPA012,PPA013,ISNULL(PPA012,0)+ISNULL(PPA013,0) PPA,PAN009 FROM MIKPAP A INNER JOIN MIKPAN B ON A.PAP001=B.PAN001 WHERE CONVERT(NVARCHAR,PAN015,112) LIKE '{0}%'" ,dt );

            return SqlHelper . ExecuteDataTable ( strSql . ToString ( ) );
        }

        /// <summary>
        /// 入库明细对比表
        /// </summary>
        /// <param name="dt"></param>
        /// <returns></returns>
        public DataTable getInventoryView ( string dt )
        {
            StringBuilder strSql = new StringBuilder ( );
            strSql . AppendFormat ( "SELECT ANN001,ANW011,ANN002,ANN003,ANN004,ANN005,ANN006,ANN007,ANN009,RCC006 FROM MIKANN A INNER JOIN MIKANW B ON A.ANN001=B.ANW001 LEFT JOIN SGMRCC C ON A.ANN001=C.RCC002 AND A.ANN003=C.RCC010 AND A.ANN002=C.RCC004 WHERE CONVERT(NVARCHAR, ANW015, 112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            /////五金报工单
            strSql . AppendFormat ( "SELECT HAW001,HAW013,HAW002,HAW003,HAW004,HAW005,HAW006,HAW007,HAW009,RCC006 FROM MIKHAW A LEFT JOIN SGMRCC B ON A.HAW001=B.RCC002 AND A.HAW002=B.RCC004 AND A.HAW003=B.RCC010 WHERE HAW009 >0 AND CONVERT(NVARCHAR, HAW010, 112) LIKe '{0}%' " ,dt );
            strSql . Append ( " UNION ALL " );
            ////面板报工单
            strSql . AppendFormat ( "SELECT LEE001,LEC010,LEE002,LEE003,LEE004,LEE005,LEE006,LEE007,LEE009,RCC006 FROM MIKLEE A INNER JOIN MIKLEC B ON B.LEC001 = A.LEE001 LEFT JOIN SGMRCC C ON A.LEE001=C.RCC002 AND A.LEE002=C.RCC004 AND A.LEE003=C.RCC010 WHERE CONVERT(NVARCHAR, LEC013, 112) LIKE '{0}%' " ,dt );
            strSql . Append ( " UNION ALL " );
            ////注塑报工单1
            strSql . AppendFormat ( "SELECT IJB001,IJB022,IJB004,IJB005,IJB006,IJB007,IJB008,IJB010,IJB015,RCC006 FROM MIKIJB A INNER JOIN MIKIJA C ON A.IJB001=C.IJA001 LEFT JOIN SGMRCC B ON A.IJB001=B.RCC002 AND A.IJB004=B.RCC004 AND A.IJB005=B.RCC010 WHERE CONVERT(NVARCHAR,IJA015, 112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            ////注塑报工单2
            strSql . AppendFormat ( "SELECT IJC001,IJA004,IJC002,IJC003,IJC004,IJC005,IJC006,IJC008,IJC010,RCC006 FROM MIKIJC A INNER JOIN MIKIJA B ON A.IJC001=B.IJA001 LEFT JOIN SGMRCC C ON A.IJC001=C.RCC002 AND A.IJC002=C.RCC004 AND A.IJC003=C.RCC010 WHERE CONVERT(NVARCHAR, IJA015, 112) LIKE '{0}%'" ,dt );
            strSql . Append ( " UNION ALL " );
            ////喷漆报工单
            strSql . AppendFormat ( "SELECT PAO001,PAN003,PAO002,PAO003,PAO004,PAO008,PAO007,PAO005,PAO012,RCC006 FROM MIKPAO A INNER JOIN MIKPAN B ON A.PAO001=B.PAN001 LEFT JOIN SGMRCC C ON A.PAO001=C.RCC002 AND A.PAO002=C.RCC004 AND A.PAO003=C.RCC010 WHERE CONVERT(NVARCHAR, PAN015, 112) LIKE '{0}%' " ,dt );
            strSql . Append ( " UNION ALL  " );
            ////LED报工单
            strSql . AppendFormat ( "SELECT LEH001,LEF012,LEH002,LEH003,LEH004,LEH005,LEH006,LEH007,LEH009,RCC006 FROM MIKLEH A INNER JOIN MIKLEF B ON A.LEH001=B.LEF001 LEFT JOIN SGMRCC C ON A.LEH001=C.RCC002 AND A.LEH002=C.RCC004 AND A.LEH003=C.RCC010 WHERE CONVERT(NVARCHAR, LEF023, 112) LIKE '{0}%'  " ,dt );
            return SqlHelper . ExecuteDataTable ( strSql . ToString ( ) );

        }


    }
}
